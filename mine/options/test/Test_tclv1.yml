# CUDA_VISIBLE_DEVICES=0 python test.py -opt options/test/Test_tclv1.yml

name: Test_tclv1.yml
model_type: MultiFrameVDModel
num_gpu: auto  # set num_gpu: 0 for cpu mode
manual_seed: 0

datasets:
  test:
    name: MultiFrameVD
    type: MultiFrameVDPairedImageDataset
    dataroot_gt: ../datasets/homo/tcl/test/target
    dataroot_lq: ../datasets/homo/tcl/test/source
    io_backend:
      type: disk
    batch_size: 1
    num_worker: 0

# network structures
network_d:
  type: DemoireNet

network_t:
  type: TemporalNet

# path
path:
  pretrain_network_d: experiments/Train_tclv1.yml/models/net_d_100000.pth
  pretrain_network_t: experiments/Train_tclv1.yml/models/net_t_100000.pth
  strict_load_d: false
  strict_load_t: false
  param_key_d: 'params_ema_d'
  param_key_t: 'params_ema_t'

# validation settings
val:
  save_img: true
  metrics:
    psnr:
      type: calculate_vd_psnr
    ssim:
      type: calculate_vd_ssim
